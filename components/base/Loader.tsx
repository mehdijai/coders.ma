"use client";

import React, { useEffect, useState } from "react";
import "@/styles/loader.scss";

export default function Loader() {
  const [display, setDisplay] = useState(true);

  useEffect(() => {
    const c = document.getElementById("c") as SVGElement | null;
    const loaderWrapper = document.querySelector(
      ".loader-wrapper"
    ) as HTMLDivElement | null;
    const dot = document.getElementById("dot") as SVGElement | null;
    const light = document.getElementById("light") as SVGElement | null;
    const lightEnd = document.getElementById(
      "light-end"
    ) as SVGStopElement | null;
    const edge = document.getElementById("edge") as SVGElement | null;
    if (!c || !dot || !light || !lightEnd || !edge || !loaderWrapper) return;

    function animate() {
      let animate = document.createElementNS(
        "http://www.w3.org/2000/svg",
        "animate"
      );

      animate.setAttribute("attributeName", "offset");
      animate.setAttribute("from", `0`);
      animate.setAttribute("to", `0.70`);
      animate.setAttribute("dur", `500ms`);
      animate.setAttribute("repeatCount", `1`);
      animate.setAttribute("calcMode", "spline");
      animate.setAttribute("keyTimes", "0;1");
      animate.setAttribute("keySplines", "0 0 0.58 1");

      lightEnd!.appendChild(animate);

      setTimeout(() => {
        animate.remove();
      }, 500);

      dot!.animate(
        [
          {
            opacity: "0",
            clipPath: "circle(0 at 50% 50%)",
          },
          {
            opacity: "1",
            clipPath: "circle(100% at 50% 50%)",
          },
        ],
        {
          duration: 500,
          delay: 200,
          easing: "ease-in-out",
          iterations: 1,
          fill: "forwards",
        }
      );
      c!.animate(
        [
          {
            opacity: "0",
            transform: "rotate(-80deg)",
          },
          {
            opacity: "1",
            transform: "rotate(0)",
          },
        ],
        {
          duration: 500,
          delay: 400,
          easing: "ease-in-out",
          iterations: 1,
          fill: "forwards",
        }
      );
      edge!.animate(
        [
          {
            opacity: "0",
            clipPath: "circle(0 at 50% 50%)",
          },
          {
            opacity: "1",
            clipPath: "circle(100% at 50% 50%)",
          },
        ],
        {
          duration: 500,
          delay: 600,
          easing: "ease-in-out",
          iterations: 1,
          fill: "forwards",
        }
      );

      setTimeout(() => {
        edge!.animate(
          [
            {
              opacity: "1",
              clipPath: "circle(100% at 50% 50%)",
            },
            {
              opacity: "0",
              clipPath: "circle(0 at 50% 50%)",
            },
          ],
          {
            duration: 500,
            easing: "ease-in-out",
            iterations: 1,
            fill: "forwards",
          }
        );
        c!.animate(
          [
            {
              opacity: "1",
              transform: "rotate(0)",
            },
            {
              opacity: "0",
              transform: "rotate(-80deg)",
            },
          ],
          {
            duration: 500,
            delay: 400,
            easing: "ease-in-out",
            iterations: 1,
            fill: "forwards",
          }
        );
        dot!.animate(
          [
            {
              opacity: "1",
              clipPath: "circle(100% at 50% 50%)",
            },
            {
              opacity: "0",
              clipPath: "circle(0 at 50% 50%)",
            },
          ],
          {
            duration: 500,
            delay: 200,
            easing: "ease-in-out",
            iterations: 1,
            fill: "forwards",
          }
        );
        loaderWrapper!.animate(
          [
            {
              opacity: "1",
              transform: "translateY(0)",
            },
            {
              opacity: "0",
              transform: "translateY(-100%)",
            },
          ],
          {
            duration: 500,
            delay: 700,
            easing: "ease-in",
            iterations: 1,
            fill: "forwards",
          }
        );
      }, 1400);
    }

    const rafId = requestAnimationFrame(animate);

    setTimeout(() => {
      cancelAnimationFrame(rafId);
      setDisplay(false);
    }, 3000);

    return () => cancelAnimationFrame(rafId);
  }, []);

  if (!display) return <></>;

  return (
    <div className="loader-wrapper">
      <svg
        width="100"
        height="72"
        viewBox="0 0 100 72"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M87.22 5.91316L66.5799 17.8291C60.3969 7.16747 48.8671 0 35.6646 0C22.4621 0 10.9324 7.16747 4.77918 17.8291C1.73245 23.0852 0 29.1477 0 35.6581C0 42.1686 1.73245 48.2311 4.77918 53.4872C10.9324 64.1488 22.4621 71.3163 35.6646 71.3163C48.8671 71.3163 60.3969 64.1488 66.55 53.4872L87.3395 65.4927C92.3875 56.7723 95.2849 46.6184 95.2849 35.8075C95.2849 24.9069 92.3277 14.6933 87.22 5.91316Z"
          fill="url(#paint0_radial_241_29)"
          id="light"
        />
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M91.2769 3.53625C96.7996 12.9991 99.9999 24.0152 99.9999 35.7669C99.9999 47.4169 96.8659 58.3711 91.4018 67.7799L83.4155 63.1637C88.0867 55.1201 90.77 45.753 90.77 35.7669C90.77 25.7032 88.0331 16.2786 83.3005 8.1695L91.2769 3.53625Z"
          fill="#0D4266"
          id="edge"
        />
        <path
          d="M57.9323 48.47L66.6012 53.4872C60.4432 64.1488 48.9046 71.3163 35.692 71.3163C22.4794 71.3163 10.9408 64.1488 4.78285 53.4872C1.73378 48.2311 0 42.1387 0 35.6581C0 29.1776 1.73378 23.0852 4.78285 17.8291C10.9408 7.16747 22.4794 0 35.692 0C48.9046 0 60.4432 7.16747 66.6012 17.8291L57.9323 22.8164C57.6034 22.9956 57.155 22.906 56.9757 22.5775C56.9458 22.5477 56.9458 22.5178 56.9159 22.4879C56.9159 22.4879 56.9159 22.4879 56.9159 22.4581C56.8561 22.3685 56.7963 22.2789 56.7365 22.1594C56.7066 22.0997 56.6768 22.04 56.617 21.9802C56.5871 21.9205 56.5572 21.8906 56.5273 21.8309C56.4974 21.7712 56.4675 21.7114 56.4077 21.6816C56.3778 21.6219 56.318 21.5621 56.2881 21.4725C56.2583 21.4427 56.2284 21.3829 56.1985 21.3531C56.1686 21.2933 56.1088 21.2336 56.0789 21.1739C56.049 21.1142 56.0191 21.0843 55.9593 21.0246C55.8995 20.9648 55.8696 20.9051 55.8099 20.8454C55.78 20.8155 55.7501 20.7857 55.7202 20.7558C55.6604 20.6662 55.6006 20.6065 55.5408 20.5169C55.5109 20.487 55.481 20.4571 55.481 20.4273C55.4213 20.3676 55.3615 20.278 55.3316 20.2182C55.3017 20.1884 55.2718 20.1286 55.2419 20.0988C55.1821 20.039 55.1223 19.9793 55.0924 19.8897C55.0625 19.8599 55.0326 19.8001 55.0028 19.7703C54.943 19.7105 54.9131 19.6508 54.8533 19.5911C54.8234 19.5313 54.7636 19.5015 54.7337 19.4418C54.7038 19.382 54.644 19.3223 54.6141 19.2924C54.5843 19.2327 54.5245 19.2028 54.4946 19.1431C54.4647 19.1132 54.4049 19.0535 54.375 19.0237C54.3152 18.9639 54.2554 18.9042 54.1957 18.8445C54.1658 18.8146 54.1359 18.7847 54.106 18.7549C54.0462 18.6951 54.0163 18.6354 53.9565 18.5757C53.8967 18.516 53.8668 18.4861 53.807 18.4264C53.7473 18.3666 53.6875 18.3069 53.6576 18.2472C53.6277 18.2173 53.6277 18.2173 53.5978 18.1874C53.538 18.1277 53.4782 18.0381 53.3885 17.9784C53.3288 17.9187 53.2989 17.8888 53.2391 17.8291C53.2092 17.7992 53.1793 17.7693 53.1195 17.7096C53.0597 17.6499 52.9999 17.5902 52.9103 17.5304C52.8804 17.5006 52.8505 17.4707 52.8206 17.4408C52.7309 17.3811 52.6711 17.2915 52.5814 17.2318C52.5515 17.2019 52.5515 17.2019 52.5515 17.2019C52.4619 17.1422 52.4021 17.0526 52.3124 16.9929C52.2825 16.963 52.2825 16.963 52.2526 16.9331C52.1629 16.8734 52.1032 16.7838 52.0135 16.7241C51.9836 16.6942 51.9836 16.6942 51.9537 16.6644C51.8939 16.6345 51.864 16.5748 51.8042 16.5449C51.7444 16.4852 51.6847 16.4254 51.6249 16.3956C51.5352 16.306 51.4156 16.2463 51.3259 16.1567C51.2363 16.0671 51.1466 16.0073 51.027 15.9177C50.9373 15.8282 50.8178 15.7684 50.6982 15.6788C50.5786 15.5892 50.4889 15.5295 50.3694 15.4399H50.3395C50.1302 15.2906 49.921 15.1413 49.7117 14.992C49.6221 14.9322 49.5025 14.8426 49.4128 14.7829C49.3231 14.7232 49.2036 14.6634 49.1139 14.5738C49.0541 14.544 48.9644 14.4843 48.9046 14.4544C48.8448 14.4245 48.7851 14.3648 48.6954 14.3349C48.5758 14.2752 48.4562 14.1856 48.3367 14.1259C48.1573 14.0363 47.9779 13.9168 47.7986 13.8272C47.7388 13.7974 47.679 13.7675 47.6192 13.7376C47.5594 13.7078 47.4997 13.6779 47.4399 13.6481C47.3801 13.6182 47.3203 13.5883 47.2605 13.5585C47.141 13.4987 47.0214 13.439 46.9018 13.3793C46.842 13.3494 46.7822 13.3195 46.7225 13.2897C46.5431 13.2001 46.3637 13.1105 46.1844 13.0209C46.1246 12.991 46.0648 12.9612 46.005 12.9313C45.9452 12.9014 45.8855 12.8716 45.8257 12.8417C45.7659 12.8118 45.7061 12.782 45.6463 12.7521C45.5865 12.7223 45.5267 12.6924 45.4968 12.6924C45.3474 12.6327 45.168 12.5431 45.0186 12.4833C44.9588 12.4535 44.9289 12.4535 44.8691 12.4236C44.8093 12.3937 44.7495 12.3639 44.6897 12.3639C44.5702 12.334 44.4506 12.2743 44.3609 12.2444C44.0919 12.1548 43.8527 12.0652 43.5837 11.9756C43.494 11.9458 43.4043 11.9159 43.2848 11.886C43.1353 11.8562 43.0157 11.7965 42.8663 11.7666C42.7168 11.7367 42.5673 11.677 42.4179 11.6471C42.3581 11.6471 42.3282 11.6173 42.2684 11.6173C42.0293 11.5575 41.82 11.4978 41.5809 11.4381C41.4912 11.4082 41.3716 11.3784 41.282 11.3784C41.1923 11.3485 41.1325 11.3485 41.0428 11.3186C40.983 11.3186 40.9232 11.2888 40.8336 11.2888C40.7738 11.2888 40.714 11.2589 40.6542 11.2589C40.5645 11.229 40.5047 11.229 40.4151 11.1992C40.3553 11.1992 40.2955 11.1693 40.2357 11.1693C40.1759 11.1693 40.146 11.1394 40.0862 11.1394C40.0265 11.1394 39.9966 11.1096 39.9368 11.1096C39.877 11.1096 39.8471 11.0797 39.7873 11.0797C39.7275 11.0797 39.6677 11.0498 39.608 11.0498C39.5482 11.0498 39.4884 11.02 39.4286 11.02C39.04 10.9603 38.6514 10.9005 38.2628 10.8707C38.203 10.8707 38.1432 10.8707 38.0834 10.8408C37.9639 10.8408 37.8144 10.8109 37.6948 10.8109C37.6649 10.8109 37.6051 10.8109 37.5753 10.8109C37.5155 10.8109 37.4557 10.8109 37.4258 10.8109C37.366 10.8109 37.2763 10.8109 37.2165 10.8109C37.1568 10.8109 37.1269 10.8109 37.0671 10.8109C36.9774 10.8109 36.8877 10.8109 36.798 10.8109C36.6486 10.8109 36.4991 10.8109 36.3795 10.8109C36.1703 10.8109 35.961 10.8109 35.7219 10.8109C26.485 10.8109 18.414 15.8282 14.0795 23.2943C11.9571 26.9676 10.7315 31.2382 10.7315 35.7776C10.7315 40.317 11.9571 44.5876 14.0795 48.2609C18.414 55.7271 26.485 60.7443 35.7219 60.7443C35.9311 60.7443 36.1404 60.7443 36.3795 60.7443C36.529 60.7443 36.6785 60.7443 36.798 60.7443C36.8877 60.7443 36.9774 60.7443 37.0671 60.7443C37.1269 60.7443 37.1568 60.7443 37.2165 60.7443C37.2763 60.7443 37.366 60.7443 37.4258 60.7443C37.6649 60.7144 37.8742 60.7144 38.1133 60.6845C38.1731 60.6845 38.2329 60.6845 38.2927 60.6547C38.6813 60.6248 39.0699 60.5651 39.4585 60.5054C39.5183 60.5054 39.5781 60.4755 39.6379 60.4755C39.6976 60.4755 39.7574 60.4456 39.8172 60.4456C39.877 60.4456 39.9069 60.4158 39.9667 60.4158C40.0265 60.4158 40.0564 60.3859 40.1161 60.3859C40.1759 60.3859 40.2058 60.356 40.2656 60.356C40.3254 60.356 40.3852 60.3262 40.445 60.3262C40.5346 60.3262 40.5944 60.2963 40.6841 60.2664C40.7439 60.2664 40.8037 60.2366 40.8635 60.2366C40.9232 60.2366 40.983 60.2067 41.0727 60.2067C41.1624 60.1769 41.2222 60.1768 41.3119 60.147C41.4015 60.1171 41.5211 60.0873 41.6108 60.0873C41.8499 60.0275 42.0592 59.9678 42.2983 59.9081C42.3581 59.9081 42.388 59.8782 42.4478 59.8782C42.5972 59.8483 42.7467 59.7886 42.8962 59.7588C43.0456 59.7289 43.1652 59.6692 43.3147 59.6393C43.4043 59.6094 43.494 59.5796 43.6136 59.5497C43.8826 59.4601 44.1517 59.3705 44.3908 59.2809C44.5104 59.2511 44.63 59.1913 44.7196 59.1615C44.7794 59.1316 44.8392 59.1017 44.899 59.1017C44.9588 59.0719 44.9887 59.0719 45.0485 59.042C45.2278 58.9823 45.3773 58.9225 45.5267 58.833C45.5865 58.8031 45.6463 58.7732 45.6762 58.7732C45.736 58.7434 45.7958 58.7135 45.8556 58.6836C45.9153 58.6538 45.9751 58.6239 46.0349 58.594C46.0947 58.5642 46.1545 58.5343 46.2143 58.5044C46.3936 58.4148 46.573 58.3253 46.7523 58.2357C46.8121 58.2058 46.8719 58.1759 46.9317 58.1461C47.0513 58.0863 47.1708 58.0266 47.2904 57.9669C47.3502 57.937 47.41 57.9072 47.4698 57.8773C47.5296 57.8474 47.5893 57.8176 47.6491 57.7877C47.7089 57.7578 47.7687 57.728 47.8285 57.6981C48.0078 57.6085 48.1872 57.4891 48.3666 57.3995C48.4861 57.3397 48.6057 57.2501 48.7253 57.1904C48.7851 57.1605 48.8448 57.1008 48.9345 57.071C48.9943 57.0411 49.084 56.9814 49.1438 56.9515C49.2334 56.8918 49.353 56.832 49.4427 56.7424C49.5324 56.6827 49.6519 56.5931 49.7416 56.5334C49.9509 56.3841 50.1601 56.2347 50.3694 56.0854H50.3993C50.5188 55.9958 50.6085 55.9361 50.7281 55.8465C50.8477 55.7569 50.9373 55.6972 51.0569 55.6076C51.1466 55.518 51.2363 55.4583 51.3558 55.3687C51.4455 55.2791 51.5651 55.2194 51.6548 55.1298C51.7145 55.07 51.7743 55.0103 51.8341 54.9804C51.8939 54.9506 51.9238 54.8908 51.9836 54.861C52.0135 54.8311 52.0135 54.8311 52.0434 54.8013C52.133 54.7415 52.1928 54.6519 52.2825 54.5922C52.3124 54.5623 52.3124 54.5623 52.3423 54.5325C52.432 54.4727 52.4918 54.3831 52.5814 54.3234C52.6113 54.3234 52.6113 54.2936 52.6113 54.2936C52.701 54.2338 52.7608 54.1442 52.8505 54.0845C52.8804 54.0546 52.9103 54.0248 52.9402 53.9949C52.9999 53.9352 53.0597 53.8755 53.1494 53.8157C53.1793 53.7859 53.2092 53.756 53.269 53.6963C53.3288 53.6365 53.3587 53.6067 53.4184 53.5469C53.4782 53.4872 53.5679 53.3976 53.6277 53.3379C53.6576 53.308 53.6576 53.308 53.6875 53.2782C53.7473 53.2184 53.807 53.1587 53.8369 53.099C53.8967 53.0393 53.9266 53.0094 53.9864 52.9497C54.0462 52.8899 54.106 52.8302 54.1359 52.7705C54.1658 52.7406 54.1956 52.7107 54.2255 52.6809C54.2853 52.6211 54.3451 52.5614 54.4049 52.5017C54.4348 52.4718 54.4946 52.4121 54.5245 52.3822C54.5544 52.3225 54.6142 52.2926 54.644 52.2329C54.7038 52.1732 54.7337 52.1433 54.7636 52.0836C54.7935 52.0239 54.8533 51.994 54.8832 51.9343C54.943 51.8745 54.9729 51.8148 55.0327 51.7551C55.0625 51.7252 55.0924 51.6655 55.1223 51.6356C55.1821 51.5759 55.2419 51.5162 55.2718 51.4266C55.3017 51.3967 55.3316 51.337 55.3615 51.3071C55.4213 51.2474 55.481 51.1578 55.5109 51.0981C55.5408 51.0682 55.5707 51.0383 55.5707 51.0085C55.6305 50.9189 55.6903 50.8591 55.7501 50.7696C55.78 50.7397 55.8099 50.7098 55.8398 50.68C55.8995 50.6202 55.9294 50.5605 55.9892 50.5008C56.0191 50.441 56.049 50.4112 56.1088 50.3515C56.1387 50.2917 56.1985 50.232 56.2284 50.1723C56.2583 50.1424 56.2881 50.0827 56.318 50.0528C56.3778 49.9931 56.4077 49.9333 56.4376 49.8438C56.4675 49.784 56.4974 49.7243 56.5572 49.6944C56.5871 49.6347 56.617 49.6048 56.6469 49.5451C56.6768 49.4854 56.7066 49.4257 56.7664 49.3659C56.8262 49.2763 56.886 49.1867 56.9458 49.0673C56.9458 49.0673 56.9458 49.0673 56.9458 49.0374C56.9757 49.0075 56.9757 48.9777 57.0056 48.9478C57.155 48.7388 57.3643 48.6193 57.6034 48.6193C57.6333 48.6193 57.6333 48.6193 57.6632 48.6193H57.6931C57.6931 48.6193 57.6931 48.6193 57.723 48.6193H57.7529H57.7828H57.8127C57.8127 48.6193 57.8426 48.6193 57.8426 48.6492C57.8426 48.6492 57.8725 48.6492 57.8725 48.679C57.9024 48.47 57.9024 48.47 57.9323 48.47Z"
          fill="#0D4266"
          id="c"
        />
        <path
          d="M48.5265 35.6582C48.5265 38.2506 47.8412 40.6941 46.6194 42.78C44.1462 47.0411 39.5572 49.9018 34.2829 49.9018C29.0086 49.9018 24.4197 47.0411 21.9464 42.78C20.7247 40.6941 20.0393 38.2506 20.0393 35.6582C20.0393 33.0657 20.7247 30.6222 21.9464 28.5364C24.4197 24.2752 29.0086 21.4146 34.2829 21.4146C39.5572 21.4146 44.1462 24.2752 46.6194 28.5364C47.8412 30.6222 48.5265 33.0657 48.5265 35.6582Z"
          fill="#56033A"
          id="dot"
        />
        <defs>
          <radialGradient
            id="paint0_radial_241_29"
            cx="0"
            cy="0"
            r="1"
            gradientUnits="userSpaceOnUse"
            gradientTransform="translate(57.2421 34.665) scale(74.9721 74.9585)"
          >
            <stop offset="0" stop-color="#0D4266" stop-opacity="0.2" />
            <stop
              id="light-end"
              offset="0.70"
              stop-color="#0D4266"
              stop-opacity="0"
            />
          </radialGradient>
        </defs>
      </svg>
    </div>
  );
}
